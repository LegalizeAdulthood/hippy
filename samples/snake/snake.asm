ORG	$0100 			; Start of Data

; FIRST SNAKE IS IN 00H,01H,02H
; SECND SNAKE IS IN 03H,04H,05H

RESET:		LDAA	#$02
		STAA	$00
		LDAA	#$01
		STAA	$01
		LDAA	#$40
		STAA	$02

		LDAA	#$40
		STAA	$03
		LDAA	#$01
		STAA	$04
		LDAA	#$10
		STAA	$05

MAINLOOP:	JSR	DISPLAY
		JSR	$DFA9			;BURASI
		ANDA	#$3F		;GET USER INPUT
		CMPA	#$00		;RESET? BURASI
		BEQ	RESET	
		CMPA	#$0A		;1ST SNAKE UP?
		BNE	CKB
		LDAB	#$02
		LDX	#$00
		BRA	CALLMKMOVE
CKB:		CMPA	#$0B		;1ST SNAKE DOWN?
		BNE	CKC
		LDAB	#$03
		LDX	#$00
		BRA	CALLMKMOVE
CKC:		CMPA	#$0C		;1ST SNAKE LEFT?
		BNE	CKD
		LDAB	#$00
		LDX	#$00
		BRA	CALLMKMOVE
CKD:		CMPA	#$0D		;1ST SNALE RIGHT?
		BNE	CK10
		LDAB	#$01
		LDX	#$00
		BRA	CALLMKMOVE
CK10:		CMPA	#$10
		BEQ	S2CALC
		CMPA	#$11
		BEQ	S2CALC
		CMPA	#$12
		BEQ	S2CALC
		CMPA	#$13
		BEQ	S2CALC
		BRA 	MAINLOOP
S2CALC:		SUBA	#$10
		STAA	$22
		LDAB 	$22
;		TBA
;		STAB	$20
		LDX	#$03		;2ND SNAKE ADDR
CALLMKMOVE:	JSR	MAKEMOVE
		LDAA	$10
		CMPA	#$FF
		BEQ	MAINLOOP
		LDAA	$12
		BEQ 	MAINLOOP
		JSR	CHKANDCOPY
		JMP 	MAINLOOP


;**********	CHKANDCOPY *******************
;IF ONE OF THE SNAKES IS IN THE CALCULATED
;POSITION THIS FUNCTION WILL NOT DO ANYTHING
;*********************************************

ORG		$200

CHKANDCOPY:	LDAA	$10
		CMPA	$00
		BNE	CMPSNK2
		LDAA	$12
		CMPA	$02
		BNE	CMPSNK2
		RTS
CMPSNK2:	LDAA	$10
		CMPA	$03
		BNE	DO_COPY
		LDAA	$12
		CMPA	$05
		BNE	DO_COPY
		RTS
		
DO_COPY:	LDAA	$10
		STAA	0,X
		LDAA	$11
		STAA	1,X
		LDAA	$12
		STAA	2,X
		RTS

;*****	DISPLAY ***********
;*DRAWS THE SNAKES        *
;**************************

ORG		$250

DISPLAY:	JSR	$0DFA0		;CLEAR SCREEN
		LDAB	$02
		CMPB	$05
		BNE	DSP_DIST
;THEY ARE IN THE SAME DISPLAY
		LDAA	$00
		ORAA	$03
		JSR	$0DFA6
		RTS
DSP_DIST:	LDAA	$00
		LDAB	$02
		JSR	$DFA6
		LDAA	$03
		LDAB	$05
		JSR	$0DFA6
		RTS

;***************** MAKEMOVE ******************
;INDEX -> BASE(LID,DIR,DID)
;B     -> KEYCODE(0,1,2,3)
;                 L,R,U,D
;RETURNS -> 10H,11H,12H
;	    (LID,DIR,DID)
;10H IS FF IF NO MOVES
;*********************************************


ORG $300

MAKEMOVE:	LDAA 0,X
		CMPA #$01
		BNE  SK01
		JMP  LED01H
SK01:		CMPA #$02
		BNE  SK02
		JMP  LED02H
SK02:		CMPA #$04
		BNE  SK03
		JMP  LED04H
SK03:		CMPA #$08
		BNE  SK04
		JMP  LED08H
SK04:		CMPA #$10
		BNE  SK05
		JMP  LED10H
SK05:		CMPA #$20
		BNE  SK06
		JMP  LED20H
SK06:		CMPA #$40
		BNE  SK07
		JMP  LED40H
SK07:		SWI		; ERROR, TERMINATE

LED01H:		LDAA	1, X
		CMPA	#$00
		BEQ	L010
		CMPA	#$01
		BEQ	L011
		SWI		; ERROR, TERMINATE
L010:		CMPB	#$00
		BEQ	L010L
		CMPB	#$03
		BEQ	L010D
		LDAA	#$FF
		STAA	$10
		RTS
L010L:		LDAA	#$01
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		ASLA
		STAA	$12
		RTS
L010D:		LDAA	#$20
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L011:		CMPB	#$01	;RIGHT?
		BEQ	L011R
		CMPB	#$03	;DOWN?
		BEQ	L011D
		LDAA	#$FF
		STAA	$10
		RTS
L011R:		LDAA	#$01
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		LSRA
		STAA	$12
		RTS
L011D:		LDAA	#$02
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
LED02H:		LDAA	1,X
		CMPA	#$00
		BEQ	L020
		CMPA	#$01
		BEQ	L021
		SWI		;ERROR TERMNATE
L020:		CMPB	#$00	;LEFT?
		BEQ	L020L
		CMPB	#$01	;RIGHT?
		BEQ	L020R
		LDAA	#$0FF
		STAA	$10
		RTS
L020L:		LDAA	#$01
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L020R:		LDAA	#$01
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		LSRA
		STAA	$12
		RTS
L021:		CMPB	#$00	;LEFT?
		BEQ	L021L
		CMPB	#$01	;RIGHT?
		BEQ	L021R
		CMPB	#$03	;DOWN?
		BEQ	L021D
		LDAA	#$0FF
		STAA	$10
		RTS
L021L:		LDAA	#$40
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L021R:		LDAA	#$40
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		LSRA
		STAA	$12
		RTS
L021D:		LDAA	#$04
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
LED04H:		LDAA	1,X
		CMPA	#$00
		BEQ	L040
		CMPA	#$01
		BEQ	L041
		SWI		;ERROR TERMINATE
L040:		CMPB	#$00	;LEFT?
		BEQ	L040L
		CMPB	#$01	;RIGHT
		BEQ	L040R
		CMPB	#$02	;UP?
		BEQ	L040U
		LDAA	#$FF
		STAA	$10
		RTS	
L040L:		LDAA	#$40
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L040R:		LDAA	#$40
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		LSRA
		STAA	$12
		RTS
L040U:		LDAA	#$02
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L041:		CMPB	#$00	;LEFT?
		BEQ	L041L
		CMPB	#$01	;RIGHT
		BEQ	L041R
		LDAA	#$FF
		STAA	$10
		RTS
L041L:		LDAA	#$08
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS	
L041R:		LDAA	#$08
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		LSRA
		STAA	$12
		RTS
LED08H:		LDAA	1,X
		CMPA	#$00
		BEQ	L080
		CMPA	#$01
		BEQ	L081
		SWI		;ERROR TERMINATE
L080:		CMPB	#$02	;UP?
		BEQ	L080U
		CMPB	#$00	;LEFT
		BEQ	L080L
		LDAA	#$FF
		STAA	$10
		RTS
L080U:		LDAA	#$10
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L080L:		LDAA	#$08
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		ASLA
		STAA	$12
		RTS
L081:		CMPB	#$02	;UP?
		BEQ	L081U
		CMPB	#$01	;RIGHT?
		BEQ	L081R
		LDAA	#$FF
		STAA	$10
		RTS
L081U:		LDAA	#$04
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L081R:		LDAA	#$08
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		LSRA
		STAA	$12
		RTS
LED10H:		LDAA	1,X
		CMPA	#$00
		BEQ	L100
		CMPA	#$01
		BEQ	L101
		SWI		;ERROR TERMINATE
L100:		CMPB	#$00	;LEFT?
		BEQ	L100L
		CMPB	#$01	;RIGHT
		BEQ	L100R
		CMPB	#$02	;UP?
		BEQ	L100U
		LDAA	#$FF
		STAA	$10
		RTS
L100L:		LDAA	#$40
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		ASLA
		STAA	$12
		RTS		
L100R:		LDAA	#$40
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L100U:		LDAA	#$20
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L101:		CMPB	#$00	;LEFT?
		BEQ	L101L
		CMPB	#$01	;RIGHT
		BEQ	L101R
		LDAA	#$FF
		STAA	$10
		RTS
L101L:		LDAA	#$08
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		ASLA
		STAA	$12
		RTS
L101R:		LDAA	#$08
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
LED20H:		LDAA	1,X
		CMPA	#$00
		BEQ	L200
		CMPA	#$01
		BEQ	L201
		SWI		
L200:		CMPB	#$00	;LEFT?
		BEQ	L200L
		CMPB	#$01	;RIGHT
		BEQ	L200R
		LDAA	#$FF
		STAA	$10
		RTS
L200L:		LDAA	#$01
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		ASLA
		STAA	$12
		RTS	
L200R:		LDAA	#$01
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L201:		CMPB	#$00	;LEFT?
		BEQ	L201L
		CMPB	#$01	;RIGHT
		BEQ	L201R
		CMPB	#$03	;DOWN?
		BEQ	L201D
		LDAA	#$FF
		STAA	$10
		RTS
L201L:		LDAA	#$40
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		ASLA
		STAA	$12
		RTS
L201R:		LDAA	#$40
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L201D:		LDAA	#$10
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
LED40H:		LDAA	1,X
		CMPA	#$00
		BEQ	L400
		CMPA	#$01
		BEQ	L401
		SWI		
L400:		CMPB	#$00	;LEFT?
		BEQ	L400L
		CMPB	#$03	;DOWN?
		BEQ	L400D
		CMPB	#$02	;UP?
		BEQ	L400U
		LDAA	#$FF
		STAA	$10
		RTS
L400L:		LDAA	#$40
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		ASLA
		STAA	$12
		RTS
L400D:		LDAA	#$10
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L400U:		LDAA	#$20
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L401:		LDAA	#$87
		STAA 	$1B
		CMPB	#$01	;RIGHT?
		BEQ	L401R
		CMPB	#$03	;DOWN?
		BEQ	L401D
		CMPB	#$02	;UP?
		BEQ	L401U
		LDAA	#$FF
		STAA	$10
		RTS
L401R:		LDAA	#$40
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		LSRA
		STAA	$12
		RTS
L401D:		LDAA	#$04
		STAA	$10
		LDAA	#$01
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS
L401U:		LDAA	#$02
		STAA	$10
		LDAA	#$00
		STAA	$11
		LDAA	2,X
		STAA	$12
		RTS

